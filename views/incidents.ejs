<% layout("layout") %>

<div class="overlay-top">

    <h2 class="fw-bold text-light text-center mb-4">All Incidents</h2>

    <div class="row mt-3">
        <% incidents.forEach(i=>{ %>
        <div class="col-md-4 mb-4">
            <div class="incident-card p-3">

                <img src="<%= i.image %>" 
                     class="rounded mb-2"
                     style="width:100%; height:180px; object-fit:cover; border-radius:10px;">
                
                <h5><%= i.title %></h5>

                <span class="badge bg-danger"><%= i.type %></span>

                <p class="small mt-2"><%= i.description.slice(0,80) %>...</p>

                <a href="/incidents/<%= i._id %>" class="btn btn-sm btn-primary w-100 mt-2">
                    View Details
                </a>
            </div>
        </div>
        <% }) %>
    </div>

</div>


<script src="/socket.io/socket.io.js"></script>
<script>
 const socket = io();

 socket.on("newIncident", (data)=>{
   alert("New Incident Reported: " + data.title);
   location.reload();  
 });
</script>
